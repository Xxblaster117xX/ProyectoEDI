@page "/crear-codigo-lista"
@using Entities.Entidades_Definicion
@rendermode InteractiveServer

<PageTitle>Crear lista de codigos</PageTitle>

<Toasts class="p-3" Messages="messages" AutoHide="true" Delay="6000" Placement="ToastsPlacement.TopRight" />

<div class="container d-flex justify-content-center align-items-center vh-100" style="margin-top: -100px">
    <div class="card p-4" style="width: 30rem;">
        <h2>Crear Lista de Códigos</h2>
        <EditForm Model="NuevaCodeList" OnValidSubmit="CrearCodeList">
            <DataAnnotationsValidator/>
            <div class="mb-3">
                <label for="name" class="form-label">Nombre:</label>
                <InputText type="text" class="form-control" id="name" @bind-value="NuevaCodeList.Name" />
                <ValidationMessage For="@(() => NuevaCodeList.Name)" />
            </div>
            <div class="mb-3">
                <label for="description" class="form-label">Descripción:</label>
                <InputTextArea class="form-control" id="description" @bind-value="NuevaCodeList.Description" rows="3" />
                <ValidationMessage For="@(() => NuevaCodeList.Description)" />
            </div>
            <div class="mb-3">
                <label for="codeFormat" class="form-label">Formato de Código:</label>
                <InputText type="text" class="form-control" id="codeFormat" @bind-value="NuevaCodeList.CodeFormat" />
                <ValidationMessage For="@(() => NuevaCodeList.CodeFormat)" />
            </div>
            <div class="d-flex justify-content-center">
                <button type="submit" class="btn btn-danger w-50">Guardar</button>
            </div>
        </EditForm>
    </div>
</div>

@code {
    private CodeList NuevaCodeList = new CodeList();
    List<ToastMessage> messages = new List<ToastMessage>();

    private void ShowMessage(ToastType toastType) => messages.Add(CreateToastMessage(toastType));

    private ToastMessage CreateToastMessage(ToastType toastType)
    => new ToastMessage
        {
            Type = toastType,
            Title = "CodeList agregado",
            HelpText = $"{DateTime.Now}",
            Message = $"Se añadio un CodeList con exito: {DateTime.Now}",
        };

    private void CrearCodeList()
    {
        Console.WriteLine($"Lista de códigos creada: {NuevaCodeList.Name} - {NuevaCodeList.Description}");
        ListadoCodigos.CodeLists.Add(NuevaCodeList); // Agregar la nueva lista de códigos a la colección
        NuevaCodeList = new CodeList(); // Reiniciar el formulario

        // Mostrar un nuevo Toast
        ShowMessage(ToastType.Success);

    }

    
}