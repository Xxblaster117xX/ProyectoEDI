@page "/modificar-mensaje/{id:int}"
@using Entities.Entidades_Definicion
@using Entities.Model.Enum
@inject NavigationManager NavigationManager
@rendermode InteractiveServer

<PageTitle>Modificar mensaje</PageTitle>

<div class="container d-flex justify-content-center align-items-center vh-100" style="margin-top:-100px">
    <div class="card p-4" style="width: 30rem;">
        <h2>Modificar Lista de Códigos</h2>
        <form @onsubmit="Modificarmensaje">
            <div class="mb-3">
                <label for="tipo" class="form-label">Tipo de Mensaje</label>
                <select class="form-select" id="tipo" @bind="Mensaje.MessageType">
                    <option value="" disabled selected>Seleccione un tipo...</option>
                    @foreach (var tipo in Enum.GetValues(typeof(MessageTypeEnum)))
                    {
                        <option value="@tipo">@tipo</option>
                    }
                </select>
            </div>
            <div class="mb-3">
                <label for="description" class="form-label">Versión:</label>
                <input class="form-control" id="description" @bind="Mensaje.MessageVersion" rows="3" required>
            </div>
            <div class="mb-3">
                <label for="codeFormat" class="form-label">Release:</label>
                <input type="text" class="form-control" id="codeFormat" @bind="Mensaje.MessageRelease" required>
            </div>
            <div class="mb-3">
                <label for="codeFormat" class="form-label">Directory Version:</label>
                <input type="text" class="form-control" id="codeFormat" @bind="Mensaje.MessageDirectoryVersion" required>
            </div>
            <div class="mb-3">
                <label for="codeFormat" class="form-label">Nombre:</label>
                <input type="text" class="form-control" id="codeFormat" @bind="Mensaje.MessageName" required>
            </div>
            <div class="mb-3">
                <label for="codeFormat" class="form-label">Descripcion:</label>
                <textarea type="text" class="form-control" id="codeFormat" @bind="Mensaje.MessageDescription" required></textarea>
            </div>
            <div class="d-flex justify-content-center">
                <button type="submit" class="btn btn-danger">Guardar Cambios</button>
            </div>
        </form>
    </div>
</div>

@code {
    [Parameter]
    public int Id { get; set; }

    private Message Mensaje = new Message();

    protected override void OnInitialized()
    {
        // Simular la carga de datos
        Mensaje = ListarMensaje.Messages.FirstOrDefault(c => c.MessageId == Id);
    }

    private void Modificarmensaje()
    {
        Console.WriteLine($"Mensaje modificado: {Mensaje.MessageName} - {Mensaje.MessageDescription}");
        var M = ListarMensaje.Messages.FirstOrDefault(c => c.MessageId == Id);
        if (M != null)
        {
            M.MessageType = Mensaje.MessageType;
            M.MessageVersion = Mensaje.MessageVersion;
            M.MessageRelease = Mensaje.MessageRelease;
            M.MessageDirectoryVersion = Mensaje.MessageDirectoryVersion;
            M.MessageName = Mensaje.MessageName;
            M.MessageDescription = Mensaje.MessageDescription;

            Console.WriteLine($"Mensaje modificado: {M.MessageName} - {M.MessageDescription}");
        }
        else
        {
            Console.WriteLine($"No se encontró unmensaje  con el ID: {Id} para modificar.");
        }

        //Redirigir al listado de mensajes
        NavigationManager.NavigateTo("/listar-mensaje");
    }
}