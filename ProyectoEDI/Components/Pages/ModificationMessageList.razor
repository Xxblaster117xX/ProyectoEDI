@page "/ModificationMessage/{MessageId:int}"
@using Entities.Entidades_Definicion
@inject NavigationManager Navigation
@rendermode InteractiveServer
@using Entities.Model.Enum


<h3>Modificar Mensaje</h3>

@if (message != null)
{
    <form class="message-form">
        <div class="form-row">
            <div class="form-group">
                <label for="messageType" class="form-label">Message Type</label>
                <select class="form-select" id="messageType" @bind="message.MessageType">
                    @foreach (var type in Enum.GetValues(typeof(MessageTypeEnum)))
                    {
                        <option value="@type">@type</option>
                    }
                </select>
            </div>

            <div class="form-group">
                <label for="messageName" class="form-label">Message Name</label>
                <input type="text" class="form-control" id="messageName" @bind="message.MessageName" placeholder="Enter message name">
            </div>

            <div class="form-group">
                <label for="messageVersion" class="form-label">Message Version</label>
                <input type="text" class="form-control" id="messageVersion" @bind="message.MessageVersion" placeholder="Enter message version">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="messageRelease" class="form-label">Message Release</label>
                <input type="text" class="form-control" id="messageRelease" @bind="message.MessageRelease" placeholder="Enter message release">
            </div>

            <div class="form-group">
                <label for="messageDirectoryVersion" class="form-label">Message Directory Version</label>
                <input type="text" class="form-control" id="messageDirectoryVersion" @bind="message.MessageDirectoryVersion" placeholder="Enter directory version">
            </div>

            <div class="form-group">
                <label for="messageDescription" class="form-label">Message Description</label>
                <textarea class="form-control" id="messageDescription" @bind="message.MessageDescription" placeholder="Enter message description"></textarea>
            </div>
        </div>

        <div class="form-buttons">
            <button type="button" class="btn btn-success" style="background-color:red" @onclick="SaveChanges">Guardar</button>
            <button type="button" class="btn btn-secondary" @onclick="Cancel">Cancelar</button>
        </div>
    </form>
}
else
{
    <p>Cargando mensaje...</p>
}
@code {
    [Parameter]
    public int MessageId { get; set; }

    private Message message;

	//Al cargar la página, se busca el mensaje por su ID
    protected override void OnInitialized() 
    {
        message = Message.MessagesList.FirstOrDefault(m => m.MessageId == MessageId);
        if (message == null)
        {
            Console.WriteLine($"No se encontró el mensaje con ID {MessageId}");
        }
        else
        {
            Console.WriteLine($"Mensaje encontrado: {message.MessageName}");
        }
    }
    
	//Al guardar los cambios, se redirige a la lista de mensajes
    public void SaveChanges()
    {
		Console.WriteLine($"Guardando cambios para el mensaje con ID {MessageId}");
        Navigation.NavigateTo("/MessagesList");
    }
	//Al cancelar los cambios, se redirige a la lista de mensajes

    public void Cancel()
    {
		Console.WriteLine($"Cancelando cambios para el mensaje con ID {MessageId}");
        Navigation.NavigateTo("/MessagesList"); 
    }
}

